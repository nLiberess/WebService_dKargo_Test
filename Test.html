
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <title>DKargo Web Test</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
   </head> 

<body style = "
background: black;
padding: 0px;
margin: 0px;
overflow: hidden;
">
<iframe id = "MainFrame" src="http://localhost:8080/" style = "width:100%;height:100%;border:0px;"> </iframe>

</body>

<script>
let submitSuccess = {
      "messageType": "submitSuccess",
      "userKey": "userKey",
      "promotionId": "promotionId",
    };
  

let data2 = {
        messageType: "init",
        userKey: "22222234",
        promotionId: "promotionId",
        language: "ko", // "ko", "ja", "en". default: "ko"
        clientId : 5,
        // 육성
        // 고정 캐릭터 셋팅. 
        characters: 7000,
        cycle:10 , // 성장주기 100% 기준으로 50%로 주기를 조정하여 진행.//  default: 100
        mode:"dev",
              
    };

    window.addEventListener("message", this.receiveMessage); 

    function receiveMessage(event) 
    {
    	if(event.data.messageType=="load"){
          SendLauncherData();
      }else if(event.data.messageType=="mode")
      {
        SendLauncherMode();
      }
      else
      {
        if(event.data.messageType==="submit")
        {
          document.getElementById("MainFrame").contentWindow.postMessage(submitSuccess, "*");
        }
        else if(event.data.messageType==="getServerTime")
        {
          var today = new Date();

          var year = today.getFullYear();
          var month = ('0' + (today.getMonth() + 1)).slice(-2);
          var day = ('0' + today.getDate()).slice(-2);

          var hours = ('0' + today.getHours()).slice(-2); 
          var minutes = ('0' + today.getMinutes()).slice(-2);
          var seconds = ('0' + today.getSeconds()).slice(-2); 

          var timeString = hours + ':' + minutes  + ':' + seconds;
          var dateString = year + '-' + month  + '-' + day;

          let ST = {
                  "messageType": "getServerTime",
                  "time": dateString+" "+timeString,
                  };

          document.getElementById("MainFrame").contentWindow.postMessage(ST, "*");
        }
        else{
         // Swal.fire({
         //     title: event.data.messageType,
         //     html: JSON.stringify(event.data),
         //     icon: "success"
         //   });
        } 
      }
     
    }

    function SendLauncherData()
    {
        document.getElementById("MainFrame").contentWindow.postMessage(data2, "*");
    }

    function SendLaunchersubmitSuccess()
    {
      document.getElementById("MainFrame").contentWindow.postMessage(submitSuccess, "*");
    }

    let mode = {
              messageType: "mode",
              mode: "development"
    };

    function SendLauncherMode()
    {
      document.getElementById("MainFrame").contentWindow.postMessage(mode, "*");
    }
</script>
</html>
